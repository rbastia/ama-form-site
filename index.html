<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>Open Form</title>
  <style>
    :root { --bg: #f7f7f9; --accent: #0a66c2; }
    html,body { height:100%; margin:0; background:var(--bg); font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; color:#111; }
    /* Use a CSS variable for the real viewport height (mobile addressing bar fix) */
    .vh-100 { height: calc(var(--vh, 1vh) * 100); display:flex; flex-direction:column; }
    header { padding:14px 16px; background:white; box-shadow:0 1px 0 rgba(0,0,0,0.06); display:flex; align-items:center; gap:12px; }
    header h1 { font-size:16px; margin:0; }
    .iframe-wrap { flex:1 1 auto; display:block; }
    iframe { width:100%; height:100%; border:0; display:block; }
    .fallback { padding:18px; text-align:center; background:white; }
    .btn { display:inline-block; padding:10px 16px; background:var(--accent); color:#fff; text-decoration:none; border-radius:8px; font-weight:600; }
    .small { font-size:13px; color:#444; margin-top:8px; display:block; }
  </style>
</head>
<body>
  <div class="vh-100">
    <header>
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden style="flex:0 0 28px">
        <rect width="24" height="24" rx="4" fill="#0a66c2"></rect>
        <path d="M7 12h10M7 8h10M7 16h6" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <h1>Open form</h1>
    </header>

    <main class="iframe-wrap" role="main">
      <!-- Replace the FORM_EMBED_URL below with your form's embed URL from Microsoft Forms.
           Example embed src typically starts with https://forms.office.com/Pages/ResponsePage.aspx?... -->
      <iframe id="formFrame" src="FORM_EMBED_URL" title="Form"></iframe>

      <!-- Fallback content shown if the iframe is blocked or fails to load -->
      <div id="fallback" class="fallback" style="display:none">
        <p style="margin:0 0 10px">The form couldn't be embedded. Open it directly:</p>
        <a id="fallbackLink" class="btn" href="#" target="_blank" rel="noopener">Open form</a>
        <span class="small">If you plan to use this on iPhone, open this page in Safari → Share → Add to Home Screen.</span>
      </div>
    </main>
  </div>

  <script>
    // Fix mobile viewport height (handles address bar on iOS/Android)
    function setVh() {
      document.documentElement.style.setProperty('--vh', (window.innerHeight * 0.01) + 'px');
    }
    setVh();
    window.addEventListener('resize', setVh);

    // Simple detect if iframe loads content or is blocked
    (function() {
      var iframe = document.getElementById('formFrame');
      var fallback = document.getElementById('fallback');
      var fallbackLink = document.getElementById('fallbackLink');

      // Set fallback link to the iframe src in case embed blocked.
      fallbackLink.href = iframe.src;

      // If the iframe does not load within X sec, show fallback link.
      var loaded = false;
      var timeout = setTimeout(function() {
        // Many cross-origin iframes don't allow access to contentDocument; we check visually by waiting.
        if (!loaded) {
          iframe.style.display = 'none';
          fallback.style.display = 'block';
        }
      }, 3000);

      // Try to listen for load event (may fire even for blocked embeds)
      iframe.addEventListener('load', function() {
        loaded = true;
        clearTimeout(timeout);
        // Small heuristic: if contentWindow length is 0 or same origin error occurs, still consider fallback.
        try {
          // Accessing location.href of cross-origin iframe will throw — so use try/catch.
          var cw = iframe.contentWindow;
          // If same-origin and blank page, show fallback.
          if (cw && cw.location && cw.location.href && cw.location.href === 'about:blank') {
            iframe.style.display = 'none';
            fallback.style.display = 'block';
          }
        } catch(e) {
          // cross-origin — assume OK, do nothing
        }
      }, false);
    })();
  </script>
</body>
</html>